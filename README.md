# 🍽️ K-means 클러스터링 급식 영양소 분석 대시보드

> **식품의약품안전처 학교급식 영양성분 DB 기반 영양소 분석 및 식단 구성 도구**

K-means 클러스터링을 활용하여 618개 급식 식품을 영양소 기준으로 분류하고, 균형잡힌 식단을 시각적으로 구성할 수 있는 인터랙티브 웹 대시보드입니다.

---

## 📊 주요 기능

### 1. 이중 탭 클러스터링 시스템
- **📊 에너지 × 나트륨 탭**: 칼로리와 나트륨 함량 기반 분류
- **🍬 당류 × 식이섬유 탭**: 당류와 식이섬유 함량 기반 분류
- 탭 전환 시 모든 UI 자동 동기화 (산점도, 통계, 검색 결과, 식판)

### 2. 인터랙티브 산점도
- **Plotly.js 기반 시각화**: 618개 식품을 산점도로 표현
- **클릭하여 식판에 추가**: 산점도의 점을 클릭하면 즉시 식판에 담김
- **별표(⭐) 강조**: 선택된 식품을 산점도에서 강조 표시
- **실루엣 스코어 표시**: 클러스터링 품질 실시간 확인
  - 에너지/나트륨: 0.4959
  - 당류/식이섬유: 0.5330

### 3. 스마트 검색 시스템
- **실시간 검색**: 식품명, 카테고리로 즉시 검색
- **클러스터 표시**: 검색 결과에 클러스터 라벨 자동 표시
- **섭취량 정보**: 현재 탭에 맞는 영양소 정보 표시
- **원클릭 추가**: 검색 결과에서 [➕] 버튼으로 식판에 추가

### 4. 오늘의 식판 기능
- **4가지 영양소 분석**
  - 에너지: ~800 kcal (WHO 청소년 기준)
  - 나트륨: ~700 mg
  - 당류: ≤10 g (권장)
  - 식이섬유: ≥8 g (권장)
- **프로그레스 바**: 목표 대비 달성률 시각화
- **클러스터별 구성**: 현재 탭 기준으로 클러스터 분포 표시
- **스마트 추천**: 영양소 균형에 따른 맞춤 조언
  - ⚠️ 나트륨 주의
  - 💡 에너지 부족
  - 🍬 당류 과다
  - 🥬 식이섬유 부족
  - ✅ 균형잡힌 식단

### 5. 클러스터별 식품 목록
- **3개 클러스터 분류**: 각 탭별로 독립적인 클러스터링
- **실시간 필터링**: 검색어에 따라 목록 동적 업데이트
- **선택 동기화**: 클릭 시 산점도와 동기화
- **노란색 강조**: 현재 선택된 식품 시각적 표시

---

## 🎯 클러스터링 결과

### 📊 에너지 × 나트륨 (k=3, 정규화 적용)

**실루엣 스코어**: 0.4959

| 클러스터 | 개수 | 평균 에너지 | 평균 나트륨 | 주요 식품 | 특징 |
|---------|------|-----------|-----------|---------|-----|
| 🟢 **Cluster 0** | 167개 | 191 kcal | 511 mg | 볶음류, 튀김류, 구이류 | 고에너지/중나트륨 - 메인 반찬 |
| 🔵 **Cluster 1** | 445개 | 65 kcal | 248 mg | 국/탕류, 생채·무침류 | 저에너지/저나트륨 - 건강한 기본 반찬 |
| 🔴 **Cluster 2** | 6개 | 66 kcal | 3,335 mg | 김치류, 장류, 절임류 | 저에너지/초고나트륨 - 조미용 소량만! |

**초고나트륨 식품 (Cluster 2)**: 초간장, 오이김치, 양파장아찌, 양배추김치, 양념초장, 보쌈김치

### 🍬 당류 × 식이섬유 (k=3, 정규화 적용)

**실루엣 스코어**: 0.5330 (더 명확한 분리!)

| 클러스터 | 개수 | 평균 당류 | 평균 식이섬유 | 특징 |
|---------|------|---------|------------|-----|
| 🔵 **Cluster 0** | 466개 | 1.1 g | 0.9 g | 저당/저식이섬유 - 대부분의 일반 식품 |
| 🟢 **Cluster 1** | 71개 | 6.0 g | 1.7 g | 고당/저식이섬유 - 단맛 나는 음식, 과일, 디저트류 |
| 🔴 **Cluster 2** | 81개 | 2.4 g | 3.3 g | 저당/고식이섬유 - 채소, 통곡물, 건강한 공급원 |

---

## 🎨 사용 방법

### 1️⃣ 식품 검색 및 선택

```
┌─────────────────────────┐
│ 🔍 검색                 │
│ [흰쌀밥_____________]   │
├─────────────────────────┤
│ ✓ 흰쌀밥  [저에너지]    │ <- 클릭!
│   밥류 | 210ml          │
│   324kcal | 2mg    [➕] │
└─────────────────────────┘
```

### 2️⃣ 산점도에서 직접 선택

```
    📈 산점도
    
    ●  ●  ●
  ●  ●  ●  ●   <- 점 클릭!
    ●  ●  ●
    
         ↓
         
    ⭐ 선택된 식품 강조
    + 식판에 자동 추가
```

### 3️⃣ 클러스터 목록에서 선택

```
┌─────────────────────────┐
│ 저에너지/저나트륨 (445개)│
├─────────────────────────┤
│ 흰쌀밥            🟨    │ <- 클릭하면 노란색
│ 현미밥                  │
│ 보리밥                  │
└─────────────────────────┘
```

### 4️⃣ 식판 관리

```
┌─────────────────────────┐
│ 🍽️ 오늘의 급식          │
├─────────────────────────┤
│ 🍚 흰쌀밥     [✕]  🟨  │ <- 클릭 시 산점도 표시
│ 🥘 된장국     [✕]      │
│ 🥬 시금치나물  [✕]      │
└─────────────────────────┘

📊 영양 분석
━━━━━━━━━━━━━━━━━━━━
에너지: 745 kcal ████████░░ 93% 🟢
나트륨: 652 mg   ████████░░ 93% 🟢
당류: 5.2 g      ████░░░░░░ 52% 🟢
식이섬유: 6.8 g  ███████░░░ 85% 🟡
```

### 5️⃣ 선택된 식품 정보

```
┌──────────────────────────────────────┐
│ 🌟 선택된 식품: 흰쌀밥                │
│ [저에너지/저나트륨]                   │
│ 밥류 | 에너지: 154.3 kcal | 나트륨: 1.0 mg │
│                                      │
│    [➕ 식판에 담기]  [✕ 선택 해제]   │
└──────────────────────────────────────┘
```

---

## 🌟 균형잡힌 식단 추천

### 🏆 추천 1번 - 가장 균형잡힌 조합
```
🍚 밥: 흰쌀밥 (210ml)
🥘 국: 무국_소고기 (300ml)  
🥬 반찬1: 시금치나물 (70ml)
🍖 반찬2: 닭고기볶음 (60ml)

📊 영양 분석:
   🟢 에너지: ~750 kcal (94%)
   🟢 나트륨: ~650 mg (93%)
   🟢 당류: ~5 g
   🟡 식이섬유: ~6 g
```

### 👍 추천 2번 - 식이섬유 풍부
```
🍚 밥: 보리밥 (300ml)
🥘 국: 콩나물국_콩나물_소고기 (250ml)
🥬 반찬1: 콩나물무침_콩나물_깨소금 (70ml)
🍖 반찬2: 돼지고기볶음_고추장 (50ml)

📊 영양 분석:
   🟡 에너지: ~700 kcal (88%)
   🟢 나트륨: ~700 mg (100%)
   🟢 당류: ~6 g
   🟡 식이섬유: ~7 g
```

### 💚 추천 3번 - 저나트륨 추천
```
🍚 밥: 현미밥 (280ml)
🥘 국: 달걀국 (200ml)
🥬 반찬1: 깻잎나물 (60ml)
🍖 반찬2: 고등어구이_카레 (40ml)

📊 영양 분석:
   🟡 에너지: ~680 kcal (85%)
   🟢 나트륨: ~550 mg (79%) ⭐
   🟢 당류: ~4 g
   🟡 식이섬유: ~6 g
```

---

## 💡 주요 특징

### ✨ 인터랙티브 UX
- **5가지 식품 선택 방법**
  1. 검색 결과 [➕] 버튼
  2. 산점도 점 직접 클릭
  3. 클러스터 목록 클릭
  4. 식판 아이템 클릭 (재선택)
  5. 선택 정보 [➕ 식판에 담기] 버튼

- **실시간 피드백**
  - ✓ 식판 추가 시 초록색 알림
  - ⚠️ 중복 추가 시 주황색 알림
  - 🟨 선택된 식품 노란색 강조
  - ⭐ 산점도 별표 표시

### 🔄 완벽한 동기화
- 탭 전환 시 모든 UI 자동 업데이트
- 선택/해제 시 모든 영역 동기화
  - 검색 결과 ↔ 산점도 ↔ 클러스터 목록 ↔ 식판

### 📱 반응형 디자인
- 데스크톱/태블릿 최적화
- 3단 레이아웃 (검색 | 분석 | 식판)
- 부드러운 애니메이션 & 호버 효과

---

## 🛠️ 기술 스택

### 데이터 분석
- **Python 3.x**
  - pandas: 데이터 전처리
  - scikit-learn: K-means 클러스터링, 정규화 (StandardScaler)
  - numpy: 수치 연산

### 웹 인터페이스
- **HTML5/CSS3**: 반응형 레이아웃
- **JavaScript (ES6+)**: 동적 UI 제어
- **Plotly.js**: 인터랙티브 산점도 시각화

### 데이터
- **출처**: 식품의약품안전처 학교급식 영양성분 DB
- **618개 식품 데이터** (school.csv)
- **컬럼**: 식품명, 식품대분류명, 식품중량, 에너지(kcal), 나트륨(mg), 당류(g), 식이섬유(g)
- **인코딩**: CP949 (한글 지원)

---

## 📁 파일 구조

```
k-means-nutrition-dashboard/
│
├── index.html                 # 단일 파일 웹 애플리케이션 (180KB)
│   ├── HTML 구조
│   ├── CSS 스타일
│   ├── JavaScript 로직
│   └── 클러스터링 데이터 (JSON 내장)
│
├── school.csv                 # 식약처 급식 영양성분 DB (618개 식품)
│
├── cluster_analysis.py        # K-means 클러스터링 스크립트 (예시)
│   ├── 데이터 로드 & 전처리
│   ├── 정규화 (StandardScaler)
│   ├── K-means (k=3, random_state=42)
│   ├── 실루엣 스코어 계산
│   └── JSON 출력
│
└── README.md                  # 이 문서
```

---

## 🚀 사용법

### 방법 1: 바로 실행 (권장)
```bash
# index.html 파일을 더블클릭하거나 브라우저로 드래그
# 모든 데이터가 내장되어 있어 즉시 실행 가능!
```

### 방법 2: 로컬 서버 실행
```bash
# Python 내장 서버 사용
python -m http.server 8000

# 브라우저에서 접속
# http://localhost:8000/index.html
```

### 방법 3: GitHub Pages 배포
```bash
# GitHub 저장소 생성 후
git init
git add index.html README.md
git commit -m "Initial commit"
git branch -M main
git remote add origin https://github.com/username/repo.git
git push -u origin main

# Settings → Pages → Deploy from main branch
# https://username.github.io/repo/
```

---

## 📊 클러스터링 알고리즘

### K-means 클러스터링 (k=3)

```python
from sklearn.cluster import KMeans
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import silhouette_score

# 1. 데이터 정규화 (중요!)
scaler = StandardScaler()
X_scaled = scaler.fit_transform(df[['에너지(kcal)', '나트륨(mg)']])

# 2. K-means 클러스터링
kmeans = KMeans(n_clusters=3, random_state=42)
labels = kmeans.fit_predict(X_scaled)

# 3. 실루엣 스코어 계산
silhouette = silhouette_score(X_scaled, labels)
print(f"Silhouette Score: {silhouette:.4f}")
```

### 정규화의 중요성
- **문제**: 에너지(0~500 kcal)와 나트륨(0~6000 mg)의 스케일 차이
- **해결**: StandardScaler로 평균 0, 분산 1로 정규화
- **결과**: 두 변수가 동등하게 클러스터링에 영향

---

## 🎓 교육적 활용

### 고등학교 AI/데이터 과학 교육
- **K-means 클러스터링** 원리 이해
- **데이터 정규화** 필요성 학습
- **실루엣 스코어** 개념 습득
- **영양학** 기본 지식 습득

### 실습 과제 예시
1. 다른 k 값으로 클러스터링 시도 (k=2, 4, 5)
2. 다른 영양소 조합으로 분석 (단백질, 지방 등)
3. 학교별 급식 데이터 비교 분석
4. 계절별 영양소 변화 추적

### 프로젝트 확장 아이디어
- 알레르기 정보 추가
- 영양소 목표량 개인화
- 주간 식단 자동 생성
- 식품 가격 정보 통합
- 칼로리 카운터 기능

---

## 📈 성능 지표

### 클러스터링 품질
- **에너지/나트륨**: 실루엣 스코어 0.4959 (양호)
- **당류/식이섬유**: 실루엣 스코어 0.5330 (우수)

### 데이터 크기
- **식품 수**: 618개
- **클러스터**: 6개 (탭당 3개)
- **JSON 크기**: ~120KB
- **HTML 크기**: 180KB (압축 가능)

### 브라우저 지원
- ✅ Chrome 90+
- ✅ Firefox 88+
- ✅ Safari 14+
- ✅ Edge 90+

---

## 🐛 문제 해결

### Q: 산점도가 표시되지 않아요
**A**: Plotly.js CDN 연결을 확인하세요. 인터넷 연결이 필요합니다.

### Q: 검색이 작동하지 않아요
**A**: 브라우저 캐시를 강력 새로고침하세요 (Ctrl+Shift+R 또는 Cmd+Shift+R)

### Q: 한글이 깨져요
**A**: school.csv 파일이 CP949 인코딩인지 확인하세요.

### Q: 클러스터 색상을 바꾸고 싶어요
**A**: HTML 파일의 `colors` 객체를 수정하세요:
```javascript
const colors = {
    0: '#10b981',  // 초록
    1: '#3b82f6',  // 파랑
    2: '#ef4444'   // 빨강
};
```

### Q: 영양소 목표량을 바꾸고 싶어요
**A**: `updateSummary()` 함수의 목표량을 수정하세요:
```javascript
const targetEnergy = 800;  // kcal
const targetSodium = 700;  // mg
const targetSugar = 10;    // g
const targetFiber = 8;     // g
```

---

## 🔄 업데이트 히스토리

### v4.0 (2026-01-19) - 최종 완성 ✨
- ✅ 산점도 클릭으로 식판 추가 기능
- ✅ 선택된 식품 정보에 [➕ 식판에 담기] 버튼
- ✅ 클러스터 목록 선택 시 노란색 강조
- ✅ 식판 아이템 클릭 시 산점도 연동
- ✅ 당류/식이섬유 프로그레스 바 추가
- ✅ 모든 UI 탭 전환 시 완벽 동기화

### v3.0 (2026-01-18)
- ✅ 이중 탭 시스템 (에너지/나트륨, 당류/식이섬유)
- ✅ 당류/식이섬유 클러스터링 추가
- ✅ 탭별 독립적 산점도 & 통계
- ✅ 에너지/나트륨 정규화 클러스터링 수정

### v2.0
- ✅ 섭취량 기반 분석 (100ml → 실제 섭취량)
- ✅ 식판 기능 추가
- ✅ WHO 권장량 기준 적용

### v1.0
- ✅ K-means 클러스터링 (k=3)
- ✅ 산점도 시각화
- ✅ 클러스터별 통계

---

## 📝 라이선스

Copyright (c) 2026 포항여자고등학교 정보 교사 최형배

본 프로젝트는 식품의약품안전처의 데이터를 바탕으로 만들어졌으며 교육 목적으로 자유롭게 사용, 수정, 배포 가능합니다.

---

**균형잡힌 식단으로 건강한 학교생활을!** 🍽️✨

---

*Last Updated: 2026-01-19*
*Data Source: 식품의약품안전처 학교급식 영양성분 DB*
